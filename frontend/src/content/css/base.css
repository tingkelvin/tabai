/* ====================================
   1. BASE WIDGET STYLES (DARK THEME DEFAULT)
   ==================================== */

/* Main widget container */
.extension-widget {
  position: fixed;
  z-index: 2147483647;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
  overflow: hidden;
  backdrop-filter: blur(20px);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Widget states */
.extension-widget.expanded {
  width: 480px;
  height: 320px;
  border-radius: 12px;
}

.extension-widget.minimized {
  border-radius: 50%;
  width: 48px;
  height: 48px;
}

/* Drag states */
.extension-widget.minimized.dragging {
  cursor: grabbing;
}

.extension-widget.expanded.dragging {
  cursor: grabbing;
}


  /* ====================================
   COMPREHENSIVE TEXT SIZE PROTECTION
   ==================================== */

/* Base extension widget text protection */
.extension-widget {
  font-size: 13px !important;
  line-height: 1.5 !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
}

/* All text elements within the extension */
.extension-widget,
.extension-widget * {
  font-size: 13px !important;
  line-height: 1.5 !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
}

/* Specific message text protection - EVERYTHING */
.extension-widget .message-text,
.extension-widget .message-text *,
.extension-widget .message-text p,
.extension-widget .message-text span,
.extension-widget .message-text div,
.extension-widget .message-text strong,
.extension-widget .message-text em,
.extension-widget .message-text li,
.extension-widget .message-text ul,
.extension-widget .message-text ol {
  font-size: 13px !important;
  line-height: 1.5 !important;
  font-family: inherit !important;
}

/* User message text - complete protection */
.extension-widget .chat-message.user .message-text,
.extension-widget .chat-message.user .message-text *,
.extension-widget .chat-message.user .message-text p,
.extension-widget .chat-message.user .message-text span,
.extension-widget .chat-message.user .message-text div {
  font-size: 13px !important;
  line-height: 1.5 !important;
}

/* Assistant message text - complete protection */
.extension-widget .chat-message.assistant .message-text,
.extension-widget .chat-message.assistant .message-text *,
.extension-widget .chat-message.assistant .message-text p,
.extension-widget .chat-message.assistant .message-text span,
.extension-widget .chat-message.assistant .message-text div {
  font-size: 13px !important;
  line-height: 1.5 !important;
}

/* Code elements - special sizing but still protected */
.extension-widget .message-text code,
.extension-widget .message-text .markdown-code {
  font-size: 11px !important; /* Slightly smaller for code */
  line-height: 1.4 !important;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace !important;
}

.extension-widget .message-text pre {
  font-size: 11px !important;
  line-height: 1.4 !important;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace !important;
}

.extension-widget .message-text pre code {
  font-size: inherit !important;
  line-height: inherit !important;
}

/* Input protection */
.extension-widget .chat-input {
  font-size: 13px !important;
  line-height: 22px !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
}

.extension-widget .chat-input::placeholder {
  font-size: 13px !important;
  line-height: 22px !important;
}

/* Button protection */
.extension-widget .custom-action-btn {
  font-size: 12px !important;
  line-height: 1 !important;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif !important;
}

/* Header protection */
.extension-widget .extension-header h3 {
  font-size: 14px !important;
  line-height: 1.2 !important;
  font-weight: 600 !important;
}

/* ====================================
   NUCLEAR OPTION - IF WEBSITES ARE VERY AGGRESSIVE
   ==================================== */

/* Override any possible text size inheritance */
.extension-widget .chat-messages {
  font-size: 13px !important;
}

.extension-widget .chat-messages * {
  font-size: inherit !important;
}

/* Ensure typing indicator matches */
.extension-widget .typing-indicator {
  font-size: 13px !important;
}

/* ====================================
   SIMPLE HEADER BUTTON FIX
   ==================================== */

/* Force button dimensions */
.extension-widget .minimize-btn,
.extension-widget .close-btn {
  width: 16px !important;
  height: 16px !important;
  min-width: 16px !important;
  min-height: 16px !important;
  max-width: 16px !important;
  max-height: 16px !important;
  padding: 0 !important;
  margin: 0px !important;
  border: none !important;
  background: transparent !important;
  outline: none !important;
  cursor: pointer !important;
  display: inline-block !important;
  vertical-align: middle !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
}

.extension-widget .minimize-btn {
  width: 16px !important;
  height: 16px !important;
  min-width: 16px !important;
  min-height: 16px !important;
  max-width: 16px !important;
  max-height: 16px !important;
  padding: 0 !important;
  margin: 0 !important;
  margin-right: 8px !important;
  border: none !important;
  background: transparent !important;
  outline: none !important;
  cursor: pointer !important;
  display: inline-block !important;
  vertical-align: middle !important;
  position: relative !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
  appearance: none !important;
}

/* Premium minimize line */
.extension-widget .minimize-btn::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 10px;
  height: 2px;
  background: #8b5cf6; /* Purple */
  border-radius: 1px;
  box-shadow: 0 0 0 rgba(139, 92, 246, 0);
  transition: all 0.3s cubic-bezier(0.4, 0.0, 0.2, 1); /* Smooth premium easing */
}

/* Premium hover effects */
.extension-widget .minimize-btn:hover::before {
  background: #7c3aed; /* Darker purple */
  width: 12px; /* Grows wider */
  height: 2.5px; /* Gets thicker */
  box-shadow: 
    0 0 8px rgba(139, 92, 246, 0.4), /* Purple glow */
    0 1px 3px rgba(0, 0, 0, 0.1); /* Subtle depth shadow */
  transform: translate(-50%, -50%) scale(1.05); /* Slight scale up */
}

/* Premium active/click state */
.extension-widget .minimize-btn:active::before {
  transform: translate(-50%, -50%) scale(0.95); /* Scale down when clicked */
  transition: all 0.1s ease; /* Quick feedback */
}

/* ====================================
   THEME VARIATIONS (OPTIONAL)
   ==================================== */

/* Dark theme - brighter purple */
@media (prefers-color-scheme: dark) {
  .extension-widget .minimize-btn::before {
    background: #a78bfa; /* Lighter purple for dark backgrounds */
  }
  
  .extension-widget .minimize-btn:hover::before {
    background: #c4b5fd;
    box-shadow: 
      0 0 10px rgba(167, 139, 250, 0.5),
      0 1px 3px rgba(0, 0, 0, 0.2);
  }
}

/* Light theme - darker purple */
@media (prefers-color-scheme: light) {
  .extension-widget .minimize-btn::before {
    background: #7c3aed; /* Darker purple for light backgrounds */
  }
  
  .extension-widget .minimize-btn:hover::before {
    background: #6d28d9;
    box-shadow: 
      0 0 8px rgba(124, 58, 237, 0.3),
      0 1px 3px rgba(0, 0, 0, 0.1);
  }
}